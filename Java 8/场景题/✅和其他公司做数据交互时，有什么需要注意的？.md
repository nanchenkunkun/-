# 典型回答

在公司间进行数据交互时，无论是通过HTTP接口还是文件传输，我们都需要关注交互过程的安全性、准确性和效率、以及合规性等问题。

### 安全性

数据交互的安全性至关重要，如何避免双方的交互数据被别人窃取到，如何防止数据泄露都是我们需要关注的。一般来说都需要在接口中进行加解密和加签验签。

1. **协议加密：**
   - 在数据传输时，需要确保数据在传输过程中不被窃取或篡改。如果是Restful交互应该优先使用HTTPS协议而不是HTTP协议。对于文件传输，可以考虑使用安全的文件传输协议如SFTP或FTPS，或在传输前对文件进行加密。
2. **数据加密：**
   - 不仅要对协议进行加密，敏感数据也需要进行加密，比如手机号、身份证号等，都需要用加密算法进行加密。
   - 发送方在发送数据之前，使用密钥将数据转换成不可读的格式（密文）。接收方使用密钥将密文转换回原始数据（明文）
   - 加密可以用对称加密，也可以用非对称加密。不管是哪种加密，公钥秘钥都是提前约定好的。

```
//双方约定好的加密key
String key = "1234567887654321";

//使用AES进行加密
AES aes = SecureUtil.aes(key.getBytes());
String encryptedData = aes.encryptBase64(originalData);
```

```
//双方约定好的加密key
String key = "1234567887654321";

AES aes = SecureUtil.aes(key.getBytes());
String decryptedData = aes.decryptStr(encryptedData);
```

3. **加签验签：**
   - 加签验签的主要目的是保证数据的完整性和确认发送方的身份，确保数据在传输过程中未被篡改，并且是由可信的发送方发送的。
   - 发送方使用密钥对数据（通常是数据的哈希值）进行签名，然后将签名附加到数据上发送。接收方使用相应的密钥验证签名的有效性，以确认数据的完整性和发送方的身份。
   - 通常来说，双方会约定对一些关键字段做加签，并且大多数都是使用带盐的加签算法。

```
// 使用RSA加签
String privateKeyBase64 = "HollisTestKey"; 
RSA rsa = new RSA(privateKeyBase64, null);
String signature = rsa.signBase64(encryptedData, KeyType.PrivateKey);

```

```
// 使用RSA验签
String signature = "";//这里需要从请求中解析出signature
String publicKeyBase64 = "HollisTestKey";
RSA rsa = new RSA(null, publicKeyBase64);
boolean isCorrect = rsa.verify(encryptedData, KeyType.PublicKey, signature);
```

4. **身份验证和授权：**
   - 对于接口调用，需要进行鉴权，确保调用者有API的访问权限，这时候就需要做授权校验了，这里可以使用 API 密钥或 OAuth 令牌、以及白名单等。
5. **文件完整性校验**
   - 如果是文件传输，一般都是直接取sftp上获取文件，这时候为了确保文件的完整性以及未被篡改，都需要做一些校验，比如说对文件做MD5，然后把MD5和文件名单独通过接口发送。接收方在拉取到文件之后自己计算出MD5，再和接口传输过来的MD5做校验即可。
6. **区块链**
   - 再有一些金融场景中，也会通过区块链的方式进行数据传输，通常是联盟链。区块链提供了一个分布式的、去中心化的数据库或账本，其中的记录一旦被添加就无法被更改或删除。
### 传输效率

接口传输的时候，需要保证传输效率，那么我们可以有以下手段来保障：

1. **专线**：使用专线进行与外部机构的接口交互也是一个很好的提升性能和安全性的方案。专线，即专用网络连接。专线提供了比公共互联网更高的带宽和更低的延迟。专线通常也比公共互联网更稳定可靠，减少了因网络拥堵或其他因素导致的数据传输中断和延迟的风险。而且专线提供了更加安全的数据传输通道，因为数据不会经过公共互联网，从而减少了数据被拦截和窃取的风险。但是专线的缺点就是成本高，
2. **数据压缩**：有的时候数据比较多的时候，可以做一些适当的数据压缩，减少数据量来提升性能。
3. **用url代替文件内容**：
   - 有的时候我们接口交互中可能有图片，这时候如果直接传输图片的BASE64可能会比较大，那么就可以考虑先把文件上传到OSS等文件存储上，然后传输一个URL地址即可。这样接收方获取到地址之后自己去下载就行了。

### 合规性

数据合规，现在真的非常非常重要了，有很多时候，我们的数据涉及到用户的个人隐私数据，就需要考虑一些数据合规的处理，这些隐私数据，如果没有用户授权，是不可以提供给第三方的。也就是说是不能传输的。那怎么办呢？

1. **隐私计算：**通过数据可用不可见的方式帮助我们进行跨机构间的数据协同。

[什么是隐私计算？](https://www.yuque.com/hollis666/fo22bm/ofkapxgnuac0nh1h?view=doc_embed)

